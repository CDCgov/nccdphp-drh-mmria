@model mmria.server.Controllers.CvsController.CVS_View_Model
@using System.Security.Claims;
@{
  //Layout = "_LayoutBase";
  //ViewBag.BreadCrumbs = true;
  var userName = "";
  
  if (User.Identities.Any(u => u.IsAuthenticated))
  {
    userName = User.Identities.First(
        u => u.IsAuthenticated && 
        u.HasClaim(c => c.Type == ClaimTypes.Name)).FindFirst(ClaimTypes.Name).Value;
  }
}

<html>
    <head>
    <link rel="stylesheet" href="../styles/cdc.app.css" />
    <!-- link href="../styles/d3/c3/0.7.20/c3.min.css" type="text/css" rel="stylesheet"-->

    <script src="/TemplatePackage/4.0/assets/vendor/js/jquery.min.js"></script>

    <!-- script src="../scripts/d3/d3/v5/d3.v5.min.js" type="text/javascript"></script>
    <script src="../scripts/d3/c3/0.7.20/c3.min.js" type="text/javascript"></script-->
    

    <!--script src="../scripts/pdf-version/pdfmake.min.js" type="text/javascript"></script>
    <script src="../scripts/pdf-version/vfs_fonts.js" type="text/javascript"></script>
    <script src="../scripts/pdf-version/chart.min.js" type="text/javascript"></script>
    <script src="../scripts/pdf-version/chartjs-plugin-datalabels/2.0/chartjs-plugin-datalabels.js" type="text/javascript"></script-->

    <script src="../scripts/mmria.js" type="text/javascript"></script>

    <script src="../scripts/cvs/index.js" type="text/javascript"></script>

</head>
<body>

<main id="content">
    <h1 class="h2" tabindex="-1">Community Vital Signs</h1>
    <p class="mb-4"><strong>Report Generated:</strong> <span id="report_datetime">@DateTime.Now.ToString("MMM d, yyyy hh:mm:ss tt")</span> by <span id=uid>@userName</span><br/>
    <span id="reporting_state" class="mb-4"></span>
    </p>
                <h2 id="header">Please wait...</h2>
                <h2 id="output">Your request is being processed. This might take several minutes.</h2>
                <span class="spinner-container spinner-content" style="display: none;">
                    <span class="spinner-body text-primary">
                        <span class="spinner"></span>
                        <span class="spinner-info">Loading...</span>
                    </span>
                </span>
    <dialog  id="loading-modal" style="top:15%;width:320px;" class="p-0 set-radius"></dialog>

    <table border=1>
        <tr>
            <th>lat</th>
            <th>lon</th>
            <th>year</th>
            <th>record id</th>
        </tr>
        <tr>
            <td>@Model.lat</td>
            <td>@Model.lon</td>
            <td>@Model.year</td>
            <td>@Model.id</td>
        </tr>
    </table>

    <input type="hidden" id="lat" name="lat" value="@Model.lat"  />
    <input type="hidden"  id="lon" name="lon" value="@Model.lon"  />
    <input type="hidden"  id="year" name="year" value="@Model.year"  />
    <input type="hidden"  id="id" name="year" value="@Model.id"  />

    <div id="report_output_id"></div>
</main>
</body>
</html>