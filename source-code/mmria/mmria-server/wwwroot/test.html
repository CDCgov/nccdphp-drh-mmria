<html>
<head>
<!--script src="scripts/rxjs.umd.js" type="text/javascript"></script>
<script src="scripts/lodash.min.js"></script>
<script src="scripts/platform.js"></script>
<script src="scripts/benchmark.js"></script-->


<style>
  #box {
    position: absolute;
    /*width: 50px;
    height: 50px;*/
    background-color: red;
    opacity: .5;
    cursor: -webkit-grab;
    cursor: grab;
  }
  #box.dragging {
    cursor: -webkit-grabbing;
    cursor: grabbing;
    background-color: green;
  }

  .mouseenter {
    background-color: aqua;
    cursor: grab;
  }

  .mousedown {
    background-color:rgb(198, 231, 232);
    cursor: grab;
  }

/*
  .no-select {
   -webkit-touch-callout: none;
   -webkit-user-select: none;
   -khtml-user-select: none;
   -moz-user-select: none;
   -ms-user-select: none;
   user-select: none;
}

::-moz-selection {
   background: transparent;
}
::selection { 
   background: transparent; 
}*/
</style>
<script type="text/javascript">



window.onload = main;

const selected = new Set();
let is_dragging = false;

let drag_start_position = null;


function main()
{

    //console.log("main");

    const body = document.body;

    
    body.addEventListener("mousedown", body_mousedown);
    body.addEventListener("mousemove", mousemove);
    body.addEventListener("mouseup", body_mouseup);
    


    const el = document.getElementById("id1");
    el.style.position = "relative";
    el.addEventListener("mouseenter", mouseenter);
    el.addEventListener("mouseleave", mouseleave);
    el.addEventListener("mousedown", mousedown);
    el.addEventListener("mouseup", mouseup);
    //el.addEventListener("drag", drag);


    const el2 = document.getElementById("box");
    //el2.addEventListener("drag", drag);
    //el2.addEventListener("dragstart", drag_start);
    //el2.addEventListener("dragend", drag_end);

}



function body_mousedown(e)
{
    is_dragging = true;
    drag_start_position = { x: e.clientX, y:e.clientY };
}

function body_mouseup(e)
{
    is_dragging = false;
    drag_start_position = null;
}
function mousemove(e)
{
    //e.currentTarget.classList.add("mouseenter");
    if(is_dragging)
    {
        const x = e.clientX - drag_start_position.x;
        const y = e.clientY - drag_start_position.y;

        //console.log("dragging");

        for (let it = selected.values(), item= null; item=it.next().value; ) 
        {
            /*
            let l = parseFloat(item.left.replace("px", ""));
            let t = parseFloat(item.top.replace("px", ""));
            */

            
            item.left += (l + x );
            item.top += (t + y);
        }
    }
}

function mouseenter(e)
{
    e.currentTarget.classList.add("mouseenter");
}


function mouseleave(e)
{
    e.currentTarget.classList.remove("mouseenter");
}


function mousedown(e)
{
    e.currentTarget.classList.add("mousedown");
    selected.add(e.currentTarget);
}


function mouseup(e)
{
    const item = e.currentTarget;
    item.classList.remove("mousedown");
    if(selected.has(item))
        selected.delete(item);
}

function drag(e)
{
    console.log("drag");
    //console.log(e);
    //e.currentTarget.classList.remove("mousedown");

    
}

function drag_start(e)
{
    console.log("drag start");
    //console.log(e);
    //e.currentTarget.classList.remove("mousedown");

    
}

function drag_end(e)
{
    console.log("drag end");
    //console.log(e);
    //e.currentTarget.classList.remove("mousedown");

    
}

</script>
</head>
<body>
<h1>hello</h1>





<div id="box">
      <h1>RxJS Drag and Drop</h1>
      <input type="text" />
</div>
  <br/>
  <br/>  <br/>
  <br/>
  <br/>
  <br/>
  <br/>
  <br/>
  <input id="id1" type="text" readonly />
  <br/>
  <br/>
<input type="time" />
  
  <br/>
  <br/>



</body>
</html>