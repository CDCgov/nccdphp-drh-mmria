<link rel="import" href="../../bower_components/polymer/polymer.html">	
<link rel="import" href="../../bower_components/paper-button/paper-button.html">	
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">	
<link rel="import" href="../../bower_components/paper-item/paper-item.html">	
<dom-module id="mmrds-summary">
	<template>  
		<!-- 
		<iron-ajax id="master_record_call" url="../../../api/master_record" handle-as="json" last-response="{{data}}" on-response="handle_response" auto></iron-ajax>
		-->
		<h2>Please select a record to work with:</h2>
		<paper-menu>
		<template id="summary_repeat" is="dom-repeat" items="{{data}}">
            <paper-item>
				<a data-route="master" href="{{baseUrl}}/[[item._id]]/home-record">
					<span>[ select ]</span>
				</a>&nbsp;
				{{item.last_name}}, {{item.first_name}} {{item.middle_name}} {{item.record_id}}
			</paper-item>
        </template>
		</paper-menu>
	</template>
	<script>
	Polymer(
	{
        is: 'mmrds-summary',
		properties: 
		{ 
			/*
			data: 
			{
				type: Array,
				value: function () 
				{
					return [];
				},
				notify: true
			}*/
		},
		ready: function ()
		{
			var ctx = this;
			var db = new PouchDB('mmrds');
			g_data = [];	
			db.allDocs({ include_docs: true }).then(function (info) 
			{
				for(var i in info.rows)
				{
					g_data.push(info.rows[i].doc);
					//console.log(info.rows[i].doc._id);
					console.log(info.rows[i].doc);	
					
				}
				this.data = g_data;
			}.bind(ctx));
		},
		handle_response: function (e) 
		{
			console.log("handle_response done.");
		}

    });
	  
	</script>
	
</dom-module>