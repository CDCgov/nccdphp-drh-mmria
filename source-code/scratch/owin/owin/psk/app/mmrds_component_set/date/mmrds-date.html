<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<dom-module id="mmrds-date">
<template>  
		<paper-input id="date_input" label="[[label]]" value="{{bound_data.date}}" pattern="\d{0,4}\-\d{0,2}\-\d{0,2}" on-blur="calculateDate" auto-validate></paper-input>
		<paper-checkbox id="is_calculated_date">[[calculated_date_label]]</paper-checkbox>
		<paper-input id="calculated_date" label="calculated date"></paper-input>
	
</template>
<script>
Polymer({
        is: 'mmrds-date',
		properties: 
		{
			bound_data: 
			{ 
				type: Object,
				notify: true
			}
		},
		calculateDate:function() 
		{
			var date_parts = this.$.date_input.value.split("-");
			var value = "";
			var is_calculated_date = false;
			
			if(date_parts.length > 2)
			{
				var temp_date = new Date();
				var year = temp_date.getFullYear();
				var month = temp_date.getMonth() + 1;
				var day = 1;
				if(date_parts[0] != "")
				{
					year = date_parts[0];
				}
				else
				{
					is_calculated_date = true;
				}
			
				if(date_parts[1] != "")
				{
					month = date_parts[1];
				}
				else
				{
					is_calculated_date = true;
				}
				
				if(date_parts[2] != "")
				{
					day = date_parts[2];
				}
				else
				{
					is_calculated_date = true;
				}
				
				value = new Date(year, month, day);
			}
			
			if(value != null && value!="")
			{
				this.$.calculated_date.value = value.toLocaleDateString();
				this.$.is_calculated_date.checked = is_calculated_date
				
			}
			else
			{
				this.$.calculated_date.value = value;
				this.$.is_calculated_date.checked = false
			}
			
			console.log('[[label]] calculateDate: ' + this.bound_data);

		}
		,
		date_is_estimated:function() 
		{
			//console.log('[[label]] date_is_estimated: ' + this.bound_data);
			return false;
		},
		_checkConfirmation: function(e) {
        if (e.keyCode === 13) {
          e.preventDefault();
          e.target.blur();
        }
      }

});
	  
	  
</script>
	
</dom-module>