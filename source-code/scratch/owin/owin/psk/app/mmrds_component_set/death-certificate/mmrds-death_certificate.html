<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../mmrds-state-dropdown/mmrds-state-dropdown.html">
<link rel="import" href="../mmrds-address/mmrds-address.html">
<link rel="import" href="../race/mmrds-race.html">
<link rel="import" href="../cause-of-death-grid/mmrds-cause_of_death_grid.html">
<link rel="import" href="../yesno/mmrds-yesno.html">
<link rel="import" href="../demographic/mmrds-demographic.html">

<dom-module id="mmrds-death_certificate">
		
	
	<template>  

		<paper-material elevation="1">			
			<h1>Death Certificate</h1>
			<div>Record Id: {{home_record.record_id }}</div>
			<div><paper-checkbox checked="{{home_record.is_valid_maternal_mortality_record }}">is a valid record</paper-checkbox></div>
			<div>Name: {{home_record.last_name }}, {{home_record.first_name }}</div>
		</paper-material>	
		

	<mmrds-address item="{{death_certificate.place_of_last_residence}}" label="Place of last residence"></mmrds-address>	


	<mmrds-demographic bound_data="{{death_certificate}}"" label="Demographics"></mmrds-demographic>
	



	<mmrds-race label="Race*" bound_data="{{death_certificate.race}}"> </mmrds-race>

	<paper-material elevation="1">	
		<h1>Injury associated information (optional)</h1>
		<paper-input label="Date of injury (YYYY-MM-DD)" value="{{death_certificate.date_of_injury}}"></paper-input>
		<paper-input label="Time of injury" value="{{death_certificate.time_of_injury}}"></paper-input>
		<paper-input label="Place of injury (Place name, if applicable)" value="{{death_certificate.place_of_injury}}"></paper-input>
		<mmrds-yesno bound_data="{{death_certificate.was_injury_at_work}}" label="Was injury at work?"></mmrds-yesno>

		
		<paper-dropdown-menu label="Transportaion related injury?">
			<paper-listbox class="dropdown-content" selected="{{death_certificate.transportation_related_injury}}" attr-for-selected="value">
				<paper-item value="Driver/Operator">Driver/Operator</paper-item>
				<paper-item value="Passenger">Passenger</paper-item>
				<paper-item value="Pedestrian">Pedestrian</paper-item>
				<paper-item value="">
					<paper-input label="Other (specify)"></paper-input>
				</paper-item>
			</paper-listbox>
		</paper-dropdown-menu>
		
		<mmrds-yesno bound_data="{{death_certificate.were_seat_belts_in_use}}" label="Were seat belts in use?"></mmrds-yesno>

		
	</paper-material>	
	
	<mmrds-address  data="{{death_certificate.address_of_injury}}" label="Location where injury occured"></mmrds-address>	
		
	<paper-material elevation="1">	
		<h1>Death information</h1>		
		<paper-dropdown-menu label="If death occured in hospital:*">
			<paper-listbox class="dropdown-content" selected="{{death_certificate.death_occured_in_hospital}}" attr-for-selected="value">
				<paper-item value="Inpatient">Inpatient</paper-item>
				<paper-item value="Outpatient/ ER">Outpatient/ ER</paper-item>
				<paper-item value="Dead on arrival">Dead on arrival</paper-item>
				<paper-item value="Not Specified">Not Specified</paper-item>
			</paper-listbox>
		</paper-dropdown-menu>
		
		<paper-dropdown-menu label="If death not in a hospital:*">
			<paper-listbox class="dropdown-content" selected="{{death_certificate.death_outside_of_hospital}}" attr-for-selected="value">
				<paper-item value="Hospice">Hospice</paper-item>
				<paper-item value="Nursing home/ LTC">Nursing home/ LTC</paper-item>
				<paper-item value="Home">Home</paper-item>
				<paper-item value=""><paper-input label="Other (specifiy)"></paper-input></paper-item>
				<paper-item value="Not Specified">Not Specified</paper-item>
			</paper-listbox>
		</paper-dropdown-menu>

		<paper-dropdown-menu label="Manner of Death*">
			<paper-listbox class="dropdown-content" selected="{{death_certificate.manner_of_death}}" attr-for-selected="value">
				<paper-item value="Natural">Natural</paper-item>
				<paper-item value="Accident">Accident</paper-item>
				<paper-item value="Suicide">Suicide</paper-item>
				<paper-item value="Self-inflicted">Self-inflicted</paper-item>
				<paper-item value="Homocide">Homocide</paper-item>
				<paper-item value="Pending investigation">Pending investigation</paper-item>
				<paper-item value="Could not be determined">Could not be determined</paper-item>
				<paper-item value="Not Specified">Not Specified</paper-item>
			</paper-listbox>
		</paper-dropdown-menu>
		
		<mmrds-yesno bound_data="{{death_certificate.was_autopsy_performed}}" label="Was autopsy performed?*"></mmrds-yesno>

		<mmrds-yesno bound_data="{{death_certificate.was_autopsy_used_for_death_coding}}" label="Was autopsy used for death coding?*"></mmrds-yesno>

		
		<paper-dropdown-menu label="Pregnancy status*">
			<paper-listbox class="dropdown-content" selected="{{death_certificate.pregnancy_status}}" attr-for-selected="value">
				<paper-item value="Not pregnant within last year">Not pregnant within last year</paper-item>
				<paper-item value="Pregnant at the time of death">Pregnant at the time of death</paper-item>
				<paper-item value="Pregnant within 42 days of death">Pregnant within 42 days of death</paper-item>
				<paper-item value="Pregnant 43 to 365 days of death">Pregnant 43 to 365 days of death</paper-item>
				<paper-item value="Unkown if pregant in last year">Unkown if pregant in last year</paper-item>
				<paper-item value="Not Specified">Not Specified</paper-item>
			</paper-listbox>
		</paper-dropdown-menu>
		
		<paper-dropdown-menu label="Did Tobacco contribute to death?">
			<paper-listbox class="dropdown-content" selected="{{death_certificate.did_tobacco_contribute_to_death}}" attr-for-selected="value">
				<paper-item value="Yes">Yes</paper-item>
				<paper-item value="Probably">Probably</paper-item>
				<paper-item value="No">No</paper-item>
				<paper-item value="Unkown">Unkown</paper-item>
				<paper-item value="Not Specified">Not Specified</paper-item>
			</paper-listbox>
		</paper-dropdown-menu>		
		
	</paper-material>	
	
	<mmrds-address item="{{death_certificate.address_of_death}}" label="Location where death occured"></mmrds-address>
	
	<paper-material elevation="1">
		<paper-input label="Estimated distance (miles) between residence and place of death*" value="{{death_certificate.estimated_death_distance_from_residence}}"></paper-input>
		<paper-button raised>Calculate distance</paper-button>
	</paper-material>

	<mmrds-cause_of_death_grid causes_of_death="{{death_certificate.causes_of_death}}"></mmrds-cause_of_death_grid>
	
	<paper-material elevation="1">
	
	<paper-input label="Reviewer's notes about the Death Certificate" value="{{death_certificate.reviewer_note}}"></paper-input>
	</paper-material>
	
	</template>
	<script>
	Polymer({
        is: 'mmrds-death_certificate',
		properties: 
		{
			home_record: 
			{ 
				type: Object,
				notify: true
			},
			current_record_id: { 
				type: String,
				notify: true,
				observer: 'currentRecordChange'
			
			},
			death_certificate: 
			{ 
				type: Object,
				notify: true
			}
		},
		currentRecordChange:function() 
		{
			  var found_index = -1;
			  for(var i = 0; i < g_data.length; i++)
			  {
				if(g_data[i]._id == this.current_record_id)
				{
					found_index = i;
					break;
				}
			  }
			  
			  if(found_index > -1)
			  {
				this.home_record = g_data[found_index];
			  }
			  else if(g_data.length > 0)
			  {
				this.home_record = g_data[0];
			  }
			  
			  if(this.home_record)
			  {
				if(this.home_record.death_certificate)
				{
					this.death_certificate = this.home_record.death_certificate;
					if(this.death_certificate.causes_of_death)
					{
						this.causes_of_death = this.death_certificate.causes_of_death;
					}
					else
					{
						this.death_certificate.causes_of_death = [];
						this.causes_of_death = this.death_certificate.causes_of_death;
					}
				}
				else
				{
					this.home_record.death_certificate = {};
					this.death_certificate = this.home_record.death_certificate;
					if(this.death_certificate.causes_of_death)
					{
						this.causes_of_death = this.death_certificate.causes_of_death;
					}
					else
					{
						this.death_certificate.causes_of_death = [];
						this.causes_of_death = this.death_certificate.causes_of_death;
					}
				}
				
			  }

			//console.log('currentRecordChange: ' + this.current_record_id);
			//console.log('home_record: ' + this.home_record);
		}
      });
	  
	  
	</script>
	
</dom-module>